<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professional documentation and portfolio site">
    <link rel="icon" type="image/svg+xml" href="./content/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <title>Site</title>
    
    <!-- ============================================================================
         MAIN STYLESHEET - Organized into logical sections
         ============================================================================ -->
    <style>
        /* Root variables for theming - overridden by JavaScript */
        :root {
            --primary: #3b82f6;
            --primary-dark: #1e40af;
            --bg-light: #ffffff;
            --bg-light-secondary: #f3f4f6;
            --text-light: #1f2937;
            --text-light-secondary: #6b7280;
            --border-light: #e5e7eb;
            
            --bg-dark: #1a1a1a;
            --bg-dark-secondary: #2d2d2d;
            --text-dark: #e5e5e5;
            --text-dark-secondary: #a0a0a0;
            --border-dark: #404040;
        }

        /* ---- Global Styles ---- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            height: 100%;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        body.dark-mode {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }

        /* ---- Typography ---- */
        h1, h2, h3, h4, h5, h6 {
            line-height: 1.3;
            margin-bottom: 0.5em;
            font-weight: 600;
        }

        h1 {
            font-size: 2.5rem;
        }

        h2 {
            font-size: 2rem;
            margin-top: 1.5em;
        }

        h3 {
            font-size: 1.5rem;
            margin-top: 1.25em;
        }

        p {
            line-height: 1.6;
            margin-bottom: 1em;
        }

        a {
            color: var(--primary);
            text-decoration: none;
            transition: opacity 0.2s;
        }

        a:hover {
            opacity: 0.8;
        }

        code {
            background-color: var(--bg-light-secondary);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        body.dark-mode code {
            background-color: var(--bg-dark-secondary);
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding: 1em;
            margin: 1em 0;
            background-color: var(--bg-light-secondary);
            font-style: italic;
        }

        body.dark-mode blockquote {
            background-color: var(--bg-dark-secondary);
        }

        /* ---- Layout Container ---- */
        #app {
            display: flex;
            height: 100vh;
            flex-direction: column;
        }

        /* ---- Header/Navigation ---- */
        header {
            background-color: var(--bg-light-secondary);
            border-bottom: 1px solid var(--border-light);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 100;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        body.dark-mode header {
            background-color: var(--bg-dark-secondary);
            border-bottom-color: var(--border-dark);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 40px;
            height: 40px;
            flex-shrink: 0;
        }

        .logo img {
            width: 100%;
            height: 100%;
        }

        .header-brand h1 {
            font-size: 1.5rem;
            margin: 0;
            line-height: 1;
        }

        .header-tagline {
            font-size: 0.85rem;
            color: var(--text-light-secondary);
            font-weight: 300;
        }

        body.dark-mode .header-tagline {
            color: var(--text-dark-secondary);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-box {
            position: relative;
            width: 250px;
        }

        .search-box input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border-light);
            border-radius: 4px;
            font-size: 0.9rem;
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: border-color 0.2s;
        }

        body.dark-mode .search-box input {
            background-color: var(--bg-dark);
            color: var(--text-dark);
            border-color: var(--border-dark);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .search-results {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--bg-light);
            border: 1px solid var(--border-light);
            border-top: none;
            border-radius: 0 0 4px 4px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 200;
            margin-top: 4px;
        }

        body.dark-mode .search-results {
            background-color: var(--bg-dark);
            border-color: var(--border-dark);
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-light);
            cursor: pointer;
            transition: background-color 0.15s;
        }

        body.dark-mode .search-result-item {
            border-bottom-color: var(--border-dark);
        }

        .search-result-item:hover {
            background-color: var(--bg-light-secondary);
        }

        body.dark-mode .search-result-item:hover {
            background-color: var(--bg-dark-secondary);
        }

        .search-result-item .title {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .search-result-item .path {
            font-size: 0.8rem;
            color: var(--text-light-secondary);
        }

        body.dark-mode .search-result-item .path {
            color: var(--text-dark-secondary);
        }

        .controls {
            display: flex;
            gap: 1rem;
        }

        .menu-btn, .theme-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--text-light);
            transition: opacity 0.2s;
            padding: 0.5rem;
        }

        body.dark-mode .menu-btn,
        body.dark-mode .theme-btn {
            color: var(--text-dark);
        }

        .menu-btn:hover, .theme-btn:hover {
            opacity: 0.7;
        }

        .menu-btn {
            display: none;
        }

        /* ---- Main Layout ---- */
        main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* ---- Sidebar Navigation ---- */
        nav.sidebar {
            width: 280px;
            background-color: var(--bg-light-secondary);
            border-right: 1px solid var(--border-light);
            overflow-y: auto;
            padding: 1rem 0;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        body.dark-mode nav.sidebar {
            background-color: var(--bg-dark-secondary);
            border-right-color: var(--border-dark);
        }

        nav.sidebar.mobile-hidden {
            display: none;
        }

        .sidebar-section {
            margin-bottom: 1.5rem;
        }

        .sidebar-section-title {
            padding: 0.5rem 1.5rem;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-light-secondary);
            letter-spacing: 0.05em;
        }

        body.dark-mode .sidebar-section-title {
            color: var(--text-dark-secondary);
        }

        .sidebar-list {
            list-style: none;
        }

        .sidebar-item {
            padding: 0.5rem 1rem;
            margin: 0;
        }

        .sidebar-link {
            display: block;
            padding: 0.5rem 0.5rem;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .sidebar-link:hover {
            background-color: var(--bg-light);
        }

        body.dark-mode .sidebar-link:hover {
            background-color: var(--bg-dark);
        }

        .sidebar-link.active {
            background-color: var(--primary);
            color: white;
            font-weight: 500;
        }

        .sidebar-link.active:hover {
            background-color: var(--primary-dark);
            color: white;
        }

        /* ---- Content Area ---- */
        .content-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .breadcrumb {
            background-color: var(--bg-light-secondary);
            border-bottom: 1px solid var(--border-light);
            padding: 0.75rem 1.5rem;
            font-size: 0.9rem;
            color: var(--text-light-secondary);
        }

        body.dark-mode .breadcrumb {
            background-color: var(--bg-dark-secondary);
            border-bottom-color: var(--border-dark);
            color: var(--text-dark-secondary);
        }

        .breadcrumb a {
            margin: 0 0.25rem;
        }

        #content {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
        }

        #content > h1:first-child {
            margin-top: 0;
        }

        /* ---- Footer ---- */
        footer {
            background-color: var(--bg-light-secondary);
            border-top: 1px solid var(--border-light);
            padding: 1.5rem;
            margin-top: auto;
            font-size: 0.9rem;
            color: var(--text-light-secondary);
            line-height: 1.6;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        body.dark-mode footer {
            background-color: var(--bg-dark-secondary);
            border-top-color: var(--border-dark);
            color: var(--text-dark-secondary);
        }

        /* ---- Responsive Design ---- */
        @media (max-width: 768px) {
            .header-left {
                flex: 1;
            }

            .search-box {
                width: 150px;
            }

            .search-box input {
                font-size: 0.85rem;
            }

            .menu-btn {
                display: block;
            }

            nav.sidebar {
                position: fixed;
                left: 0;
                top: 0;
                height: 100vh;
                width: 250px;
                z-index: 300;
                border-right: 2px solid var(--border-light);
            }

            body.dark-mode nav.sidebar {
                border-right-color: var(--border-dark);
            }

            nav.sidebar.mobile-hidden {
                display: none;
            }

            main {
                width: 100%;
            }

            #content {
                padding: 1.5rem;
            }

            h1 {
                font-size: 1.75rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            h3 {
                font-size: 1.25rem;
            }
        }

        @media (max-width: 480px) {
            header {
                flex-wrap: wrap;
                gap: 1rem;
                padding: 0.75rem 1rem;
            }

            .header-left {
                order: 1;
            }

            .controls {
                order: 2;
                margin-left: auto;
            }

            .search-box {
                order: 3;
                width: 100%;
                flex-basis: 100%;
            }

            .header-brand h1 {
                font-size: 1.2rem;
            }

            nav.sidebar {
                width: 100%;
            }

            #content {
                padding: 1rem;
            }

            h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <!-- ============================================================================
         HTML STRUCTURE - Main app container with header, sidebar, content, footer
         ============================================================================ -->
    <div id="app">
        <!-- Header with branding, search, and theme toggle -->
        <header>
            <div class="header-left">
                <div class="logo">
                    <img src="./content/logo.svg" alt="Logo" loading="lazy">
                </div>
                <div class="header-brand">
                    <h1 id="site-name">Site</h1>
                    <div class="header-tagline" id="site-tagline">Documentation & Resources</div>
                </div>
            </div>

            <div class="header-right">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="Search docs...">
                    <div class="search-results" id="search-results"></div>
                </div>

                <div class="controls">
                    <button class="menu-btn" id="menu-toggle" aria-label="Toggle menu">â˜°</button>
                    <button class="theme-btn" id="theme-toggle" aria-label="Toggle theme">ðŸŒ™</button>
                </div>
            </div>
        </header>

        <!-- Main content layout -->
        <main>
            <!-- Sidebar navigation -->
            <nav class="sidebar" id="sidebar">
                <ul class="sidebar-list" id="menu"></ul>
            </nav>

            <!-- Content area -->
            <div class="content-wrapper">
                <div class="breadcrumb" id="breadcrumb"></div>
                <div id="content"></div>
            </div>
        </main>

        <!-- Footer -->
        <footer id="footer"></footer>
    </div>

    <!-- ============================================================================
         JAVASCRIPT - Single-page application logic
         ============================================================================ -->
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.0/+esm" type="module"></script>
    
    <script type="module">
        import { marked } from "https://cdn.jsdelivr.net/npm/marked@12.0.0/+esm";

        // ---- Global State ----
        // These store the parsed configuration and content structure
        let SITE_CONFIG = {};
        let THEME_CONFIG = {};
        let CONTENT_STRUCTURE = {};
        let CONTENT_CACHE = {};
        let SEARCH_CACHE = [];

        // ---- Configuration Loading ----
        /**
         * Loads and parses the `manifest.yaml` file which contains all configuration
         * Returns the parsed YAML object.
         */
        async function loadManifest() {
            try {
                const response = await fetch('./content/manifest.yaml');
                if (!response.ok) throw new Error('Manifest not found');
                const text = await response.text();
                // Use js-yaml (loaded as window.jsyaml)
                const data = window.jsyaml.load(text);
                return data || {};
            } catch (error) {
                console.error('Error loading manifest:', error);
                return {};
            }
        }

        /**
         * Initializes site configuration from manifest frontmatter
         */
        async function initializeConfig() {
            const manifest = await loadManifest();
            SITE_CONFIG = manifest.config || {};
            THEME_CONFIG = manifest.theme || {};

            // Apply theme colors to CSS variables
            applyThemeColors(THEME_CONFIG);

            // Set window title
            if (SITE_CONFIG.window_title) {
                document.title = SITE_CONFIG.window_title;
            }

            // Update header branding
            if (SITE_CONFIG.site_name) {
                document.getElementById('site-name').textContent = SITE_CONFIG.site_name;
            }
            if (SITE_CONFIG.tagline) {
                document.getElementById('site-tagline').textContent = SITE_CONFIG.tagline;
            }

            return manifest;
        }

        /**
         * Applies theme colors from manifest to CSS variables
         * Detects current theme and applies appropriate color scheme
         */
        function applyThemeColors(themeConfig) {
            const isDarkMode = document.body.classList.contains('dark-mode');
            const themeKey = isDarkMode ? 'dark_mode' : 'light_mode';
            const colors = themeConfig[themeKey] || {};

            if (colors.primary) document.documentElement.style.setProperty('--primary', colors.primary);
            if (colors.primary_dark) document.documentElement.style.setProperty('--primary-dark', colors.primary_dark);
            if (colors.bg) document.documentElement.style.setProperty(`--bg-${isDarkMode ? 'dark' : 'light'}`, colors.bg);
            if (colors.text) document.documentElement.style.setProperty(`--text-${isDarkMode ? 'dark' : 'light'}`, colors.text);
        }

        // ---- Content Discovery ----
        /**
         * Discovers all content by reading manifest.md structure
         * Builds CONTENT_STRUCTURE object mapping file paths
         */
        async function discoverContent() {
            const manifest = await loadManifest();
            const sections = manifest.sections || {};

            CONTENT_STRUCTURE = {};

            for (const [folderName, folderData] of Object.entries(sections)) {
                if (typeof folderData === 'object' && folderData.pages) {
                    CONTENT_STRUCTURE[folderName] = {
                        title: folderData.display_name || folderData.title || titleCase(folderName),
                        position: folderData.menu_position || folderData.menu_position || folderData.position || 999,
                        pages: folderData.pages
                    };
                }
            }

            return CONTENT_STRUCTURE;
        }

        /**
         * Converts string to Title Case (e.g., 'home' -> 'Home')
         */
        function titleCase(str) {
            return str.replace(/\b\w/g, char => char.toUpperCase());
        }

        /**
         * Formats filename for display (e.g., 'first-post.md' -> 'First Post')
         */
        function formatFileName(name) {
            return name
                .replace(/\.md$/, '')
                .replace(/\.yaml$/, '')
                .split('-')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');
        }

        // ---- Content Loading ----
        /**
         * Loads markdown file content with caching
         * Also builds search index while loading
         */
        async function loadMarkdown(folder, file) {
            // Now we expect YAML files with a `body` field containing markdown
            const path = `./content/${folder}/${file}.yaml`;
            const cacheKey = `${folder}/${file}`;

            // Return cached content if available
            if (CONTENT_CACHE[cacheKey]) {
                return CONTENT_CACHE[cacheKey];
            }

            try {
                const response = await fetch(path);
                if (!response.ok) throw new Error('File not found');

                const text = await response.text();
                const parsed = window.jsyaml.load(text) || {};

                const body = parsed.body || '';

                CONTENT_CACHE[cacheKey] = {
                    frontmatter: parsed,
                    content: body,
                    html: await marked.parse(body)
                };

                // Add to search index
                SEARCH_CACHE.push({
                    title: parsed.title || formatFileName(file),
                    content: body,
                    path: `#/${folder}/${file}`,
                    folder: folder,
                    file: file
                });

                return CONTENT_CACHE[cacheKey];
            } catch (error) {
                console.error(`Error loading ${path}:`, error);
                return null;
            }
        }

        /**
         * Loads layout content (header and footer) from manifest
         */
        async function loadLayout(manifest) {
            const layout = manifest.layout || {};

            let headerHTML = '';
            let footerHTML = '';

            if (layout.header) {
                headerHTML = await marked.parse(layout.header);
            }
            if (layout.footer) {
                footerHTML = await marked.parse(layout.footer);
            }

            return { headerHTML, footerHTML };
        }

        // ---- Navigation Building ----
        /**
         * Builds the sidebar navigation menu from CONTENT_STRUCTURE
         */
        async function buildSidebar() {
            const menu = document.getElementById('menu');
            menu.innerHTML = '';

            const sortedSections = Object.entries(CONTENT_STRUCTURE)
                .sort((a, b) => (a[1].position || 999) - (b[1].position || 999));

            for (const [folderName, folderData] of sortedSections) {
                if (!folderData.pages || folderData.pages.length === 0) continue;

                // Section title
                const section = document.createElement('li');
                section.className = 'sidebar-section';

                const sectionTitle = document.createElement('div');
                sectionTitle.className = 'sidebar-section-title';
                sectionTitle.textContent = folderData.title;
                section.appendChild(sectionTitle);

                // Section list
                const list = document.createElement('ul');
                list.className = 'sidebar-list';

                for (const page of folderData.pages) {
                    const itemName = page.name || page;
                    const itemTitle = page.title || formatFileName(itemName);
                    
                    const item = document.createElement('li');
                    item.className = 'sidebar-item';

                    const link = document.createElement('a');
                    link.className = 'sidebar-link';
                    link.href = `#/${folderName}/${itemName}`;
                    link.textContent = itemTitle;

                    item.appendChild(link);
                    list.appendChild(item);
                }

                section.appendChild(list);
                menu.appendChild(section);
            }
        }

        /**
         * Updates active link styling based on current route
         */
        function updateActiveLink(folder, file) {
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });

            const currentLink = document.querySelector(`a[href="#/${folder}/${file}"]`);
            if (currentLink) {
                currentLink.classList.add('active');
            }
        }

        /**
         * Builds breadcrumb navigation
         */
        function buildBreadcrumb(folder, file) {
            const breadcrumb = document.getElementById('breadcrumb');
            breadcrumb.innerHTML = '';

            const homeBreadcrumb = document.createElement('a');
            homeBreadcrumb.href = '#/home/index';
            homeBreadcrumb.textContent = 'ðŸ“„ Home';

            breadcrumb.appendChild(homeBreadcrumb);

            if (folder !== 'home') {
                const folderTitle = CONTENT_STRUCTURE[folder]?.title || titleCase(folder);
                const folderCrumb = document.createElement('span');
                folderCrumb.textContent = ' / ' + folderTitle;
                breadcrumb.appendChild(folderCrumb);
            }

            if (file !== 'index') {
                const fileTitle = formatFileName(file);
                const fileCrumb = document.createElement('span');
                fileCrumb.textContent = ' / ' + fileTitle;
                breadcrumb.appendChild(fileCrumb);
            }
        }

        // ---- Routing ----
        /**
         * Router function - handles hash-based routing and content display
         * Pattern: #/folder/file or default to #/home/index
         */
        async function router() {
            // Parse hash: #/folder/file
            let hash = window.location.hash.slice(1) || '/home/index';
            const parts = hash.split('/').filter(p => p);

            let folder = parts[0] || 'home';
            let file = parts[1] || 'index';

            // Validate folder exists
            if (!CONTENT_STRUCTURE[folder]) {
                window.location.hash = '#/home/index';
                return;
            }

            // Load content
            const content = await loadMarkdown(folder, file);
            if (!content) {
                window.location.hash = '#/home/index';
                return;
            }

            // Update UI
            updateActiveLink(folder, file);
            buildBreadcrumb(folder, file);
            
            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = `<h1>${content.frontmatter.title || formatFileName(file)}</h1>\n${content.html}`;

            // Scroll to top
            contentDiv.scrollTop = 0;
        }

        // ---- Search Functionality ----
        /**
         * Searches content cache for matching terms
         * Returns array of matching pages
         */
        function searchDocs(query) {
            if (!query.trim()) return [];

            const lowerQuery = query.toLowerCase();
            return SEARCH_CACHE.filter(item =>
                item.title.toLowerCase().includes(lowerQuery) ||
                item.content.toLowerCase().includes(lowerQuery)
            ).slice(0, 10);
        }

        /**
         * Wires up search input and results display
         */
        function wireUpSearch() {
            const searchInput = document.getElementById('search-input');
            const searchResults = document.getElementById('search-results');
            let debounceTimer;

            searchInput.addEventListener('input', (e) => {
                clearTimeout(debounceTimer);
                const query = e.target.value;

                debounceTimer = setTimeout(() => {
                    if (!query.trim()) {
                        searchResults.classList.remove('active');
                        return;
                    }

                    const results = searchDocs(query);
                    searchResults.innerHTML = results.map(r => `
                        <div class="search-result-item" onclick="window.location.hash = '${r.path}'">
                            <div class="title">${r.title}</div>
                            <div class="path">${r.folder}/${r.file}</div>
                        </div>
                    `).join('');

                    searchResults.classList.toggle('active', results.length > 0);
                }, 200);
            });

            // Close search on focus loss
            searchInput.addEventListener('blur', () => {
                setTimeout(() => searchResults.classList.remove('active'), 100);
            });
        }

        // ---- UI Controls ----
        /**
         * Theme toggle - switches between light and dark mode
         * Persists preference to localStorage
         */
        function setupThemeToggle() {
            const themeBtn = document.getElementById('theme-toggle');
            const savedTheme = localStorage.getItem('theme') || 'light';

            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeBtn.textContent = 'â˜€ï¸';
            }

            themeBtn.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                const isDark = document.body.classList.contains('dark-mode');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                themeBtn.textContent = isDark ? 'â˜€ï¸' : 'ðŸŒ™';
                applyThemeColors(THEME_CONFIG);
            });
        }

        /**
         * Mobile menu toggle
         */
        function setupMobileMenu() {
            const menuBtn = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');

            menuBtn.addEventListener('click', () => {
                sidebar.classList.toggle('mobile-hidden');
            });

            // Close menu when link clicked on mobile
            if (window.innerWidth <= 768) {
                sidebar.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => {
                        sidebar.classList.add('mobile-hidden');
                    });
                });
            }
        }

        /**
         * Keyboard shortcuts
         * Ctrl+K: Focus search
         * Escape: Close search results
         */
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('search-input').focus();
                }
                if (e.key === 'Escape') {
                    document.getElementById('search-results').classList.remove('active');
                }
            });
        }

        // ---- Initialization ----
        /**
         * Main initialization function - runs on page load
         * Loads config, builds UI, and sets up event listeners
         */
        async function init() {
            try {
                // Load configuration
                const manifest = await initializeConfig();
                
                // Discover content structure
                await discoverContent();
                
                // Build navigation
                await buildSidebar();
                
                // Load layout (header/footer)
                const layout = await loadLayout(manifest);
                if (layout.footerHTML) {
                    document.getElementById('footer').innerHTML = layout.footerHTML;
                }
                
                // Warm up search cache by loading all content
                for (const [folder, data] of Object.entries(CONTENT_STRUCTURE)) {
                    for (const page of data.pages) {
                        const fileName = typeof page === 'string' ? page : page.name;
                        await loadMarkdown(folder, fileName);
                    }
                }
                
                // Set up UI controls
                setupThemeToggle();
                setupMobileMenu();
                setupKeyboardShortcuts();
                wireUpSearch();
                
                // Start router
                window.addEventListener('hashchange', router);
                await router();
                
            } catch (error) {
                console.error('Initialization error:', error);
                document.getElementById('content').innerHTML = '<h1>Error loading site</h1><p>Please refresh the page.</p>';
            }
        }

        // Run initialization when DOM is ready
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
